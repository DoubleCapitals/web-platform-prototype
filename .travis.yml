language: python
python:
  - "3.6"

services:
  - docker

before_install:
  - pip install coveralls
  - docker pull opensutd/web-platform:latest-dev

script:
  - docker run --rm -e TRAVIS_JOB_ID="$TRAVIS_JOB_ID" -e TRAVIS_BRANCH="$TRAVIS_BRANCH" -e GH_ACCESS_TOKEN="$GH_ACCESS_TOKEN" -v ${PWD}:/app opensutd/web-platform:latest-dev bash -c './refresh_db.sh && coverage run --source=. manage.py test && coveralls'
